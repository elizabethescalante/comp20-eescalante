<!DOCTYPE html>

<html>

<head>
    <meta charset="utf-8" />
    <title>Captain's Log</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>
        $(document).ready(function(){
            $(document).keypress(function(e) {
                if (e.which == 13) {
                    var message = $('#msg').val();
                    localStorage[getDate()] = message;
                    display();
                    var message = $('#msg').val('')
                }
            });
        });

        // Display what's in sorted localStorage in reverse order (newest first)
        function display() {
            
            var sortedArray = sortLocalStorage();
            var output = "";
            for (var i = sortedArray.length - 1; i >= 0; i--) {
                output = output + "<p>" + sortedArray[i] + " - " + localStorage.getItem(localStorage.key(i)) + "</p>\n";
            }

            $('#log').html(output);
        }

        // Sort localStorage by timestamp (key)
        function sortLocalStorage(){
           if(localStorage.length > 0){
              var localStorageArray = new Array();
              for (var i = 0; i < localStorage.length; i++){
                  localStorageArray[i] = localStorage.key(i);
              }
           }
           var sortedArray = localStorageArray.sort();
           return sortedArray;
        }

        // Get the date and format it correctly
        function getDate() {
            var day = new Date().getUTCDay();
            if (day == 0)
                day = 'Sunday';
            else if (day == 1) 
                day = 'Monday';
            else if (day == 2) 
                day = 'Tuesday';
            else if (day == 3) 
                day = 'Wednesday';
            else if (day == 4) 
                day = 'Thursday';
            else if (day == 5) 
                day = 'Friday';
            else if (day == 6) 
                day = 'Saturday';

            var month = new Date().getMonth();
            if (month == 0)
                month = 'January';
            else if (month == 1) 
                month = 'February';
            else if (month == 2) 
                month = 'March';
            else if (month == 3) 
                month = 'April';
            else if (month == 4) 
                month = 'May';
            else if (month == 5) 
                month = 'June';
            else if (month == 6) 
                month = 'July';
            else if (month == 7) 
                month = 'August';
            else if (month == 8) 
                month = 'September';
            else if (month == 9) 
                month = 'October';
            else if (month == 10) 
                month = 'November';
            else if (month == 11) 
                month = 'December';

            var date = new Date().getDate();
            var year = new Date().getFullYear();
            var hour = new Date().getHours();
            var min = new Date().getMinutes();
            var sec = new Date().getSeconds();
           
            return day + ' ' + month + ' ' + date + ' ' + year + ' ' + hour + ':' + min + ':' + sec;
        }
    </script>
</head>

<body>
    <h1>Captain's Log</h1>
    <h3>New entry: <input type="text" id="msg" name="msg" size="30" /></h3>
    <div id="log"></div>
</body>
</html>
